{"ast":null,"code":"import{Box,Button,Card,CardContent,CardMedia,Typography}from'@mui/material';import{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import useDeleteProduct from'@/hooks/shopping/useDeleteProduct';import useProducts from'@/hooks/shopping/useProducts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ProductMainPage=()=>{const navigate=useNavigate();const[pagination,setPagination]=useState({limit:5,page:1});const{data:products,refetch,isLoading}=useProducts(pagination);const[allProducts,setAllProducts]=useState([]);const{mutate:deleteProduct}=useDeleteProduct();useEffect(()=>{if(products){setAllProducts(prevProducts=>[...prevProducts,...products]);}},[products]);useEffect(()=>{const handleScroll=()=>{if(window.innerHeight+window.scrollY>=document.documentElement.scrollHeight-100&&!isLoading){setPagination(prev=>({...prev,page:prev.page+1}));}};window.addEventListener('scroll',handleScroll);return()=>window.removeEventListener('scroll',handleScroll);},[isLoading]);useEffect(()=>{refetch();},[pagination,refetch]);const handleDelete=id=>{const confirmDelete=window.confirm('삭제하겠습니까?');if(confirmDelete){deleteProduct(id,{onSuccess:()=>{setAllProducts(prevProducts=>prevProducts.filter(product=>product.id!==id));}});}};return/*#__PURE__*/_jsxs(Box,{sx:{padding:'20px',display:'flex',flexDirection:'column',gap:'20px'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Products\"}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',flexDirection:'column',gap:'15px'},children:allProducts===null||allProducts===void 0?void 0:allProducts.map(product=>/*#__PURE__*/_jsxs(Card,{onClick:()=>navigate(\"\".concat(product.id)),sx:{display:'flex',flexDirection:{xs:'column',sm:'row'},minWidth:275,cursor:'pointer',boxShadow:3,transition:'transform 0.2s','&:hover':{transform:'scale(1.02)'}},children:[product.images[0]&&/*#__PURE__*/_jsx(CardMedia,{component:\"img\",image:product.images[0],alt:product.name,sx:{width:{xs:'100%',sm:160},height:160}}),/*#__PURE__*/_jsxs(CardContent,{sx:{flex:'1 1 auto'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:'bold'},children:product.name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{marginBottom:1},children:product.summary}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",color:\"primary\",sx:{fontWeight:'medium'},children:[product.price.toFixed(2),\"\\uFFE6\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{marginTop:1},children:[\"Owner: \",product.shop.owner.nickname,\" | Store: \",product.shop.name]}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",onClick:e=>{e.stopPropagation();navigate(\"\".concat(product.id));},sx:{marginTop:2},children:\"View Details\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",color:\"error\",onClick:e=>{e.stopPropagation();handleDelete(product.id);},sx:{marginTop:2,marginLeft:1},children:\"Delete\"})]})]},product.id))})]});};export default ProductMainPage;","map":{"version":3,"names":["Box","Button","Card","CardContent","CardMedia","Typography","useEffect","useState","useNavigate","useDeleteProduct","useProducts","jsx","_jsx","jsxs","_jsxs","ProductMainPage","navigate","pagination","setPagination","limit","page","data","products","refetch","isLoading","allProducts","setAllProducts","mutate","deleteProduct","prevProducts","handleScroll","window","innerHeight","scrollY","document","documentElement","scrollHeight","prev","addEventListener","removeEventListener","handleDelete","id","confirmDelete","confirm","onSuccess","filter","product","sx","padding","display","flexDirection","gap","children","variant","map","onClick","concat","xs","sm","minWidth","cursor","boxShadow","transition","transform","images","component","image","alt","name","width","height","flex","fontWeight","color","marginBottom","summary","price","toFixed","marginTop","shop","owner","nickname","size","e","stopPropagation","marginLeft"],"sources":["/Users/hano/dev/snu/iot/iot-final/src/pages/shopping/ProductMainPage.tsx"],"sourcesContent":["import { Box, Button, Card, CardContent, CardMedia, Typography } from '@mui/material'\nimport { useEffect, useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\n\nimport { ProductItemModel } from '@/apis/shopping/getProducts'\nimport useDeleteProduct from '@/hooks/shopping/useDeleteProduct'\nimport useProducts from '@/hooks/shopping/useProducts'\n\nconst ProductMainPage = () => {\n  const navigate = useNavigate()\n  const [pagination, setPagination] = useState({ limit: 5, page: 1 })\n  const { data: products, refetch, isLoading } = useProducts(pagination)\n  const [allProducts, setAllProducts] = useState<ProductItemModel[]>([])\n  const { mutate: deleteProduct } = useDeleteProduct()\n\n  useEffect(() => {\n    if (products) {\n      setAllProducts((prevProducts) => [...prevProducts, ...products])\n    }\n  }, [products])\n\n  useEffect(() => {\n    const handleScroll = () => {\n      if (window.innerHeight + window.scrollY >= document.documentElement.scrollHeight - 100 && !isLoading) {\n        setPagination((prev) => ({ ...prev, page: prev.page + 1 }))\n      }\n    }\n\n    window.addEventListener('scroll', handleScroll)\n    return () => window.removeEventListener('scroll', handleScroll)\n  }, [isLoading])\n\n  useEffect(() => {\n    refetch()\n  }, [pagination, refetch])\n\n  const handleDelete = (id: number) => {\n    const confirmDelete = window.confirm('삭제하겠습니까?')\n    if (confirmDelete) {\n      deleteProduct(id, {\n        onSuccess: () => {\n          setAllProducts((prevProducts) => prevProducts.filter((product) => product.id !== id))\n        }\n      })\n    }\n  }\n\n  return (\n    <Box sx={{ padding: '20px', display: 'flex', flexDirection: 'column', gap: '20px' }}>\n      <Typography variant=\"h4\">Products</Typography>\n\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>\n        {allProducts?.map((product) => (\n          <Card\n            onClick={() => navigate(`${product.id}`)}\n            key={product.id}\n            sx={{\n              display: 'flex',\n              flexDirection: { xs: 'column', sm: 'row' },\n              minWidth: 275,\n              cursor: 'pointer',\n              boxShadow: 3,\n              transition: 'transform 0.2s',\n              '&:hover': { transform: 'scale(1.02)' }\n            }}\n          >\n            {product.images[0] && (\n              <CardMedia\n                component=\"img\"\n                image={product.images[0]}\n                alt={product.name}\n                sx={{ width: { xs: '100%', sm: 160 }, height: 160 }}\n              />\n            )}\n            <CardContent sx={{ flex: '1 1 auto' }}>\n              <Typography\n                variant=\"h6\"\n                sx={{ fontWeight: 'bold' }}>{product.name}</Typography>\n              <Typography\n                variant=\"body2\"\n                color=\"text.secondary\"\n                sx={{ marginBottom: 1 }}>\n                {product.summary}\n              </Typography>\n              <Typography\n                variant=\"subtitle1\"\n                color=\"primary\"\n                sx={{ fontWeight: 'medium' }}>\n                {product.price.toFixed(2)}￦\n              </Typography>\n              <Typography\n                variant=\"body2\"\n                color=\"text.secondary\"\n                sx={{ marginTop: 1 }}>\n                Owner: {product.shop.owner.nickname} | Store: {product.shop.name}\n              </Typography>\n              <Button\n                size=\"small\"\n                variant=\"outlined\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  navigate(`${product.id}`)\n                }}\n                sx={{ marginTop: 2 }}\n              >\n                View Details\n              </Button>\n              <Button\n                size=\"small\"\n                variant=\"outlined\"\n                color=\"error\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  handleDelete(product.id)\n                }}\n                sx={{ marginTop: 2, marginLeft: 1 }}\n              >\n                Delete\n              </Button>\n            </CardContent>\n          </Card>\n        ))}\n      </Box>\n    </Box>\n  )\n}\n\nexport default ProductMainPage\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}